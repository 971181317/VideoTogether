<!-- copy from https://github.com/lovexy-fun/insd -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-base64@3.6.1/base64.min.js"></script>
    <title>install</title>
</head>
<body>
    <p>注意这个页面仅供测试使用，通过此页面安装的插件将无法更新</p>
    <button onclick="install()">安装</button>
</body>
<script>
    function install() {
        if (typeof(window.via) =="undefined" || typeof(window.via.addon) =="undefined") {
            alert("不是Via或Alook");
        } else {
            window.via.addon(encode());
        }
    }

    function encode() {
        var plugin = {
            author: "maggch@outlook.com",
            code: Base64.encode(getScript()),
            id: 1656139986,
            name: "Video Together",
            url: "*"
        }
        return Base64.encode(JSON.stringify(plugin));
    }

    function getScript() {
        var url = "https://cdn.jsdelivr.net/gh/maggch97/VideoTogether@0.1.4/source/js/vt.js"
        var script = "";
        $.ajax({
            url: url,
            method: "get",
            async: false,
            success: function (res) {
                script = res;
            }
        });
        return script;
    }
</script>
</html>